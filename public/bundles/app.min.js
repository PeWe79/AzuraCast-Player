(()=>{"use strict";var t={902:t=>{t.exports={mContext:null,mAudio:null,mSource:null,mGain:null,mAnalyser:null,mFreq:new Uint8Array(32),mHasfreq:!1,mCounter:0,mEvents:{},setupAudio:function(){var t=this;this.mAudio&&this.mContext||(this.mAudio=new Audio,this.mContext=new(window.AudioContext||window.webkitAudioContext),this.mSource=this.mContext.createMediaElementSource(this.mAudio),this.mAnalyser=this.mContext.createAnalyser(),this.mGain=this.mContext.createGain(),this.mAnalyser.fftSize=32,this.mSource.connect(this.mAnalyser),this.mSource.connect(this.mGain),this.mGain.connect(this.mContext.destination),this.mAudio.addEventListener("canplay",(function(e){t.mFreq=new Uint8Array(t.mAnalyser.frequencyBinCount),t.mAudio.play()})),["waiting","playing","ended","stalled","error"].forEach((function(e){t.mAudio.addEventListener(e,(function(i){return t.emit(e,i)}))})))},on:function(t,e){t&&"function"==typeof e&&(this.mEvents[t]=e)},emit:function(t,e){t&&this.mEvents.hasOwnProperty(t)&&this.mEvents[t](e)},getFreqData:function(t){if(!this.mAnalyser)return 0;this.mAnalyser.getByteFrequencyData(this.mFreq);var e=Math.floor(0|this.mFreq[4])/255;return!this.mHasfreq&&e&&(this.mHasfreq=!0),this.mHasfreq?e:(this.mCounter=t?this.mCounter<.6?this.mCounter+.01:this.mCounter:this.mCounter>0?this.mCounter-.01:this.mCounter,this.mCounter)},setVolume:function(t){this.mGain&&(t=(t=(t=(t=parseFloat(t)||0)>1?t/100:t)>1?1:t)<0?0:t,this.mAudio.muted=t<=0,this.mGain.gain.value=t)},stopAudio:function(){if(this.mAudio){try{this.mAudio.pause()}catch(t){}try{this.mAudio.stop()}catch(t){}try{this.mAudio.close()}catch(t){}}},playSource:function(t){this.setupAudio(),this.stopAudio(),"suspended"===this.mContext.state&&this.mContext.resume().then((function(){console.log("Audio context has been resumed.")})),this.mAudio.src=String(t||"")+"?x="+Date.now(),this.mAudio.preload="metadata",this.mAudio.crossOrigin="anonymous",this.mAudio.autoplay=!1,this.mAudio.load()}}},247:()=>{Vue.component("fav-btn",{props:{id:{type:String,default:"",required:!0},text:{type:String,default:"",required:!1},active:{type:Boolean,default:!1}},template:'\n    <button class="hover-text focus-text" @click.stop="$emit( \'change\', id, !active )" title="Toggle save favorite station">\n      <span>\n        <i v-if="active" class="ico ico-favs-check text-primary fx fx-drop-in" key="on"></i>\n        <i v-else class="ico ico-favs-add fx fx-drop-in" key="off"></i>\n      </span>\n      <span v-if="text">&nbsp; {{ text }}</span>\n    </button>'})},67:()=>{Vue.filter("toCommas",(function(t,e){var i={style:"decimal",minimumFractionDigits:e,maximumFractionDigits:e};return new Intl.NumberFormat("en-US",i).format(t)})),Vue.filter("toText",(function(t,e){return(t=String(t||"").replace(/[^\w\`\'\-\,\.\!\?]+/g," ").replace(/\s\s+/g," ").trim())||String(e||"")}))},497:(t,e,i)=>{var s,n=(s=i(311))&&s.__esModule?s.default:s;t.exports={mWrap:null,mCanvas:null,mRenderer:null,mScene:null,mCamera:null,mBox:null,mMouse:{x:0,y:0},mObjects:[],setupCanvas:function(){this.mWrap=document.querySelector("#player-wrap"),this.mCanvas=document.querySelector("#player-canvas"),this.mBox=this.mWrap.getBoundingClientRect(),this.mScene=new THREE.Scene,this.mRenderer=new THREE.WebGLRenderer({canvas:this.mCanvas,alpha:!0,antialias:!0,precision:"lowp"}),this.mRenderer.setClearColor(0,0),this.mRenderer.setPixelRatio(window.devicePixelRatio),this.mCamera=new THREE.PerspectiveCamera(60,this.mBox.width/this.mBox.height,.1,2e4),this.mCamera.lookAt(this.mScene.position),this.mCamera.position.set(0,0,300),this.mCamera.rotation.set(0,0,0),this.mObjects.push(n);var t=!0,e=!1,i=void 0;try{for(var s,r=this.mObjects[Symbol.iterator]();!(t=(s=r.next()).done);t=!0)s.value.create(this.mBox,this.mScene)}catch(t){e=!0,i=t}finally{try{!t&&r.return&&r.return()}finally{if(e)throw i}}window.addEventListener("mousemove",this.updateMouse.bind(this)),window.addEventListener("resize",this.updateSize.bind(this)),this.updateMouse(),this.updateSize()},updateObjects:function(t){var e=!0,i=!1,s=void 0;try{for(var n,r=this.mObjects[Symbol.iterator]();!(e=(n=r.next()).done);e=!0)n.value.update(this.mBox,this.mMouse,t)}catch(t){i=!0,s=t}finally{try{!e&&r.return&&r.return()}finally{if(i)throw s}}this.mRenderer.render(this.mScene,this.mCamera)},updateSize:function(){this.mWrap&&this.mCanvas&&(this.mBox=this.mWrap.getBoundingClientRect(),this.mCanvas.width=this.mBox.width,this.mCanvas.height=this.mBox.height,this.mCamera.aspect=this.mBox.width/this.mBox.height,this.mCamera.updateProjectionMatrix(),this.mRenderer.setSize(this.mBox.width,this.mBox.height))},updateMouse:function(t){if(this.mBox){var e=this.mBox.left+this.mBox.width/2,i=this.mBox.top+this.mBox.height/2;t?(this.mMouse.x=Math.max(0,t.pageX||t.clientX||0)-e,this.mMouse.y=Math.max(0,t.pageY||t.clientY||0)-i):(this.mMouse.x=e,this.mMouse.y=i)}}}},555:t=>{var e="https://stream.cloudmu.id/api";t.exports={getChannels:function(t){var i=this,s=e+"/stations",n="There was a problem fetching the latest list of music channels from AzuraCast.";axios.get(s).then((function(e){var s=i._parseChannels(e.data);return s.length?t(null,s):t(n,[])})).catch((function(e){return t(n+String(e.message||""),[])}))},getSongs:function(t,e){var i=t.songsurl||"",s="There was a problem loading the list of songs for channel "+(t.name||"...")+" from AzuraCast.";axios.get(i).then((function(t){return t.data?e(null,t.data):e(s,[])})).catch((function(t){return e(s+String(t.message||""),[])}))},_parseChannels:function(t){var i=[];if(Array.isArray(t)){var s=!0,n=!1,r=void 0;try{for(var o,a=t[Symbol.iterator]();!(s=(o=a.next()).done);s=!0){var h=o.value;h.plsfile=h.playlist_pls_url,h.mp3file=h.listen_url,h.songsurl=e+"/nowplaying/"+h.id,h.image="/public/img/"+h.shortcode+".png",h.infourl=h.url,h.twitter=h.twitter?"https://twitter.com/@"+h.twitter:"",h.route="/station/"+h.shortcode,h.listeners=0|h.mounts[0].listeners.current,h.updated=0|h.updated,h.favorite=!1,h.active=!1,i.push(h)}}catch(t){n=!0,r=t}finally{try{!s&&a.return&&a.return()}finally{if(n)throw r}}}return i}}},311:t=>{t.exports={group:null,shapes:[],move:new THREE.Vector3(0,0,0),touch:!1,ease:8,create:function(t,e){this.group=new THREE.Object3D;for(var i=new THREE.CircleGeometry(1,10),s=new THREE.CircleGeometry(2,20),n=new THREE.SphereGeometry(100,30,14).vertices,r=new THREE.MeshNormalMaterial({transparent:!0,opacity:0,side:THREE.DoubleSide}),o=new THREE.Vector3(0,0,0),a=0;a<n.length;a++){var h=n[a],u=h.x,l=h.y,c=h.z,d={x:u,y:l,z:c},m=THREE.Math.randInt(0,100),f=THREE.Math.randInt(10,30),p=new THREE.Mesh(a%2?i:s,r);p.position.set(u,l,c),p.lookAt(o),p.userData={radius:12,cycle:m,pace:f,home:d},this.group.add(p)}this.touch="ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0,this.group.position.set(40,5,0),this.group.rotation.x=Math.PI/2+.6,e.add(this.group)},update:function(t,e,i){var s=t.width<800?0:40,n=t.width<800?-60:20,r=.5+.5*i;this.touch?this.group.position.x=s:(this.move.x=s+-.012*e.x,this.group.position.x+=(this.move.x-this.group.position.x)/this.ease,this.group.position.y+=(this.move.y-this.group.position.y)/this.ease),this.group.position.z=n+80*i,this.group.rotation.y-=.003;for(var o=0;o<this.group.children.length;o++){var a=this.group.children[o],h=a.userData,u=h.radius,l=h.cycle,c=h.pace,d=h.home;a.material.opacity=.2+.8*i,a.position.set(d.x,d.y,d.z),a.translateZ(r*Math.sin(l/c)*u),a.userData.cycle++}}}},291:t=>{t.exports={set:function(t,e,i){if(this._isStr(t)){var s=Date.now(),n=Number(i)||0,r=JSON.stringify({time:s,expire:n,data:e});window.localStorage.setItem(t,r)}},get:function(t){if(this._isStr(t)){var e=window.localStorage.getItem(t)||"{}",i=JSON.parse(e)||{},s=i.time,n=i.expire,r=i.data;return this._isExpired(s,n)&&this.delete(t),r}},delete:function(t){this._isStr(t)&&window.localStorage.removeItem(t)},_isStr:function(t){return t&&"string"==typeof t},_isExpired:function(t,e){return!(!t||!e)&&(Date.now()-t)/1e3>=e}}},374:t=>{var e,i;t.exports={search:(e=function(t,e,i){var s=new RegExp("^("+i+")","i");return t.filter((function(t){return s.test(t[e])}))},i=function(t,i,s){return e.apply(this,arguments)},i.toString=function(){return e.toString()},i),sort:function(t,e,i,s){return t.sort((function(t,n){if(t.hasOwnProperty(e)){var r=t[e],o=n[e];if(s&&(r="string"==typeof r?r.toUpperCase():r,o="string"==typeof o?o.toUpperCase():o),"asc"===i){if(r<o)return-1;if(r>o)return 1}if("desc"===i){if(r>o)return-1;if(r<o)return 1}}return 0}))}}},332:(t,e,i)=>{i.r(e)}},e={};function i(s){var n=e[s];if(void 0!==n)return n.exports;var r=e[s]={exports:{}};return t[s](r,r.exports,i),r.exports}i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t=function(t){return t&&t.__esModule?t.default:t};i(332),i(67),i(247);var e=t(i(555)),s=t(i(902)),n=t(i(497)),r=t(i(374)),o=t(i(291));new Vue({el:"#app",data:{init:!1,visible:!0,playing:!1,loading:!1,sidebar:!1,volume:100,sbActive:!1,sbVisible:!1,route:"/",stations:[],station:{},songs:[],track:{},image:{},history:{},favorites:[],errors:{},timeStart:0,timeDisplay:"00:00:00",timeItv:null,searchText:"",sortParam:"listeners",sortOrder:"desc",anf:null,sto:null,itv:null},watch:{playing:function(){this.playing?this.startClock():this.stopClock()},volume:function(){s.setVolume(this.volume)}},computed:{channelsList:function(){var t=this,e=this.stations.slice(),i=this.searchText.replace(/[^\w\s\-]+/g,"").replace(/[\r\s\t\n]+/g," ").trim();return i&&i.length>1&&(e=r.search(e,"title",i)),this.sortParam&&(e=r.sort(e,this.sortParam,this.sortOrder,!1)),this.station.shortcode&&(e=e.map((function(e){return e.active=t.station.shortcode===e.shortcode,e}))),e},songsList:function(){var t=this.history;return console.log("HIST =>",t),t},sortLabel:function(){switch(this.sortParam){case"title":return"Station Name";case"listeners":return"Listeners Count";case"favorite":return"Saved Favorites";case"genre":return"Music Genre"}},canPlay:function(){return!(!this.station.shortcode||this.loading)},hasChannel:function(){return!!this.station.shortcode},hasSongs:function(){return!!this.songs.length},hasErrors:function(){return!(!this.errors.support&&!this.errors.stream&&(!this.errors.stations||this.stations.length))}},methods:{setupMaintenance:function(){var t=this;this.itv=setInterval((function(){t.getChannels(t.sidebar),t.getSongs(t.station)}),3e4)},setError:function(t,e){var i=Object.assign({},this.errors);i[t]=String(e||"").trim(),e&&console.warn("ERROR("+t+"):",e),this.errors=i},clearError:function(t){var e=Object.assign({},this.errors);delete e[t],this.errors=e},hasError:function(t){return t&&this.errors.hasOwnProperty(t)},flushErrors:function(){this.errors={}},setupEvents:function(){var t=this;document.addEventListener("visibilitychange",(function(){t.visible="visible"===document.visibilityState})),window.addEventListener("hashchange",(function(){return t.applyRoute(window.location.hash)})),window.addEventListener("keydown",this.onKeyboard),s.on("waiting",this.onWaiting),s.on("playing",this.onPlaying),s.on("ended",this.onEnded),s.on("error",this.onError)},initPlayer:function(){var t=this;setTimeout((function(){document.querySelector("#_spnr").style.display="none",document.querySelector("#player-wrap").style.opacity="1",t.init=!0}),100)},resetPlayer:function(){this.closeAudio(),this.flushErrors(),this.station={},this.songs=[]},tryAgain:function(){this.hasError("support")?(this.flushErrors(),setTimeout(this.setupAudio,1)):(this.flushErrors(),this.playChannel(this.station))},toggleSidebar:function(t){var e=this;"boolean"==typeof t&&t?(this.sbActive=!0,this.sbVisible=!0,this.$refs.sidebarDrawer.focus()):(this.sbVisible=!1,setTimeout((function(){e.sbActive=!1}),500))},togglePlay:function(t){if(t&&t.preventDefault(),!this.loading)return this.playing?this.closeAudio():void this.playChannel(this.station)},saveVolume:function(){o.set("player_volume",this.volume)},loadVolume:function(){var t=parseInt(o.get("player_volume"))||100;this.volume=t},loadSortOptions:function(){var t=o.get("sorting_data");t&&t.param&&(this.sortParam=t.param),t&&t.order&&(this.sortOrder=t.order)},toggleSortOrder:function(){this.sortOrder="asc"===this.sortOrder?"desc":"asc"},sortBy:function(t,e){this.sortParam===t?this.toggleSortOrder():this.sortOrder=e||"asc",this.sortParam=t,o.set("sorting_data",{param:this.sortParam,order:this.sortOrder})},loadFavorites:function(){var t=o.get("favorites_data");Array.isArray(t)&&(this.favorites=t)},saveFavorites:function(){var t=this,e="#EXTM3U",i=!0,s=!1,n=void 0;try{for(var r,o=this.favorites[Symbol.iterator]();!(i=(r=o.next()).done);i=!0)!function(){var i=r.value,s=t.stations.filter((function(t){return t.shortcode===i})).shift();if(!s)return"continue";e+="\n\n",e+="#EXTINF:0,"+s.title+" [AzuraCast]\n",e+=""+s.mp3file}()}catch(t){s=!0,n=t}finally{try{!i&&o.return&&o.return()}finally{if(s)throw n}}var a=document.createElement("a");a.setAttribute("href","data:audio/mpegurl;charset=utf-8,"+encodeURIComponent(e)),a.setAttribute("download","azuracast_favorites.m3u"),a.setAttribute("target","_blank"),document.body.appendChild(a),setTimeout((function(){return a.click()}),100),setTimeout((function(){return a.remove()}),1e3)},toggleFavorite:function(t,e){var i=this.favorites.slice();i=i.filter((function(e){return e!==t})),e&&i.push(t),this.favorites=i,this.updateCurrentChannel(),o.set("favorites_data",i)},closeAudio:function(){s.stopAudio(),this.playing=!1},setupCanvas:function(){n.setupCanvas()},updateCanvas:function(){if(this.anf=requestAnimationFrame(this.updateCanvas),this.visible){var t=s.getFreqData(this.playing);n.updateObjects(t)}},getChannels:function(t){var i=this;e.getChannels((function(e,s){if(e)return i.setError("stations",e);i.stations=s,i.clearError("stations"),i.updateCurrentChannel(),i.applyRoute(window.location.hash,t)}))},getSongs:function(t,i){var s=this;t&&t.shortcode&&t.songsurl&&(this.isCurrentChannel(t)||(this.songs=[],this.track={},this.image={},this.history={}),e.getSongs(t,(function(t,e){if(t)return s.setError("songs",t);"function"==typeof i&&i(e),s.track=e.now_playing.song,s.songs=e.now_playing,s.image=e.now_playing.song,s.history=e.song_history,s.clearError("songs")})))},isCurrentChannel:function(t){return!!(t&&t.shortcode&&this.station.shortcode)&&this.station.shortcode===t.shortcode},updateCurrentChannel:function(){var t=!0,e=!1,i=void 0;try{for(var s,n=this.stations[Symbol.iterator]();!(t=(s=n.next()).done);t=!0){var r=s.value;r.favorite=this.favorites.indexOf(r.shortcode)>=0,this.isCurrentChannel(r)&&(this.station=Object.assign(this.station,r),r.active=!0)}}catch(t){e=!0,i=t}finally{try{!t&&n.return&&n.return()}finally{if(e)throw i}}},playChannel:function(t){!this.playing&&t&&t.mp3file&&(this.loading=!0,s.playSource(t.mp3file),s.setVolume(this.volume))},selectChannel:function(t){var e=void 0!==arguments[1]&&arguments[1];t&&t.shortcode&&(this.isCurrentChannel(t)||(this.closeAudio(),this.toggleSidebar(!1),this.setRoute(t.route),this.getSongs(t),this.station=t,e&&this.playChannel(t)))},setRoute:function(t){t="/"+String(t||"").replace(/^[\#\/]+|[\/]+$/g,"").trim(),window.location.hash=t,this.route=t},applyRoute:function(t){var e=void 0!==arguments[1]&&arguments[1],i=String(t||"").replace(/^[\#\/]+|[\/]+$/g,"").trim().split("/"),s=i.length?i.shift():"",n=i.length?i.shift():"";if("station"===s&&n){var r=this.stations.filter((function(t){return t.shortcode===n})).shift();if(r&&r.shortcode)return this.selectChannel(r)}this.closeAudio(),this.resetPlayer(),this.toggleSidebar(e)},onKeyboard:function(t){var e=t.key||"";return" "===e&&this.station.shortcode?this.togglePlay():"Enter"===e?this.toggleSidebar(!0):"Escape"===e?this.toggleSidebar(!1):void 0},onWaiting:function(t){var e=this;this.sto&&clearInterval(this.sto),this.sto=setTimeout((function(){return e.onError(t)}),1e4),this.playing=!1,this.loading=!0},onPlaying:function(t){this.clearError("stream"),this.playing=!0,this.loading=!1},onEnded:function(t){this.playing=!1,this.loading=!1},onError:function(t){this.closeAudio(),this.setError("stream","The selected stream ("+this.station.title+") could not load, or stopped loading due to network problems."),this.playing=!1,this.loading=!1},startClock:function(){this.stopClock(),this.timeStart=Date.now(),this.timeItv=setInterval(this.updateClock,1e3),this.updateClock()},updateClock:function(){var t=function(t){return t<10?"0"+t:""+t},e=(Date.now()-this.timeStart)/1e3,i=Math.floor(e%60),s=Math.floor(e/60%60),n=Math.floor(e/3600);this.timeDisplay=t(n)+":"+t(s)+":"+t(i)},stopClock:function(){this.timeItv&&clearInterval(this.timeItv),this.timeItv=null},clearTimers:function(){this.sto&&clearTimeout(this.sto),this.itv&&clearInterval(this.itv),this.anf&&cancelAnimationFrame(this.anf)},setCssHeight:function(t,e){t.style.setProperty("--height",e+"px")},updateHeight:function(){var t=this,e=document.querySelector(":root");this.setCssHeight(e,window.innerHeight),window.addEventListener("resize",(function(i){return t.setCssHeight(e,window.innerHeight)}))}},mounted:function(){this.loadSortOptions(),this.loadFavorites(),this.loadVolume(),this.setupEvents(),this.getChannels(!0),this.setupCanvas(),this.updateCanvas(),this.setupMaintenance(),this.updateHeight(),this.initPlayer()},destroyed:function(){this.closeAudio(),this.clearTimers()}})})()})();